<!DOCTYPE html>
<html lang="fr" xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<body>
<nav class="navbar navbar-expand-lg" th:fragment="navbar">
  <div class="container-fluid">
    <a class="navbar-brand d-flex align-items-center gap-2" th:href="@{/}">
      <div class="d-flex align-items-center justify-content-center rounded-2"
           style="width:36px;height:36px;background:linear-gradient(135deg,#818cf8 0%,#4f46e5 100%);">
        <i class="bi bi-mortarboard-fill text-white"></i>
      </div>
      <span class="fw-bold text-white">EduForge</span>
    </a>

    <button class="navbar-toggler border-0" type="button" data-bs-toggle="collapse" data-bs-target="#nav">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="nav" class="collapse navbar-collapse">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0 flex-row flex-wrap gap-1">
        <!-- Général -->
        <li class="nav-item">
          <a class="nav-link px-2" th:href="@{/}">
            <i class="bi bi-house me-1"></i>Accueil
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link px-2" th:href="@{/catalog}">
            <i class="bi bi-grid-3x3-gap me-1"></i>Catalogue
          </a>
        </li>
        <li class="nav-item" sec:authorize="isAuthenticated()">
          <a class="nav-link px-2" th:href="@{/dashboard}">
            <i class="bi bi-speedometer2 me-1"></i>Dashboard
          </a>
        </li>
        <li class="nav-item" sec:authorize="isAuthenticated()">
          <a class="nav-link px-2" th:href="@{/messages}">
            <i class="bi bi-envelope me-1"></i>Messages
          </a>
        </li>

        <!-- Admin -->
        <li class="nav-item dropdown" sec:authorize="hasRole('ADMIN')">
          <a class="nav-link dropdown-toggle px-2" href="#" role="button" data-bs-toggle="dropdown">
            <i class="bi bi-shield-lock me-1"></i>Admin
          </a>
          <ul class="dropdown-menu">
            <li><a class="dropdown-item" th:href="@{/admin/dashboard}"><i class="bi bi-graph-up me-2"></i>Dashboard</a></li>
            <li><a class="dropdown-item" th:href="@{/admin/users}"><i class="bi bi-people me-2"></i>Utilisateurs</a></li>
            <li><a class="dropdown-item" th:href="@{/admin/courses}"><i class="bi bi-journal-text me-2"></i>Cours</a></li>
            <li><a class="dropdown-item" th:href="@{/stats/admin}"><i class="bi bi-bar-chart me-2"></i>Statistiques</a></li>
          </ul>
        </li>

        <!-- Institution -->
        <li class="nav-item dropdown" sec:authorize="hasRole('INSTITUTION_MANAGER')">
          <a class="nav-link dropdown-toggle px-2" href="#" role="button" data-bs-toggle="dropdown">
            <i class="bi bi-building me-1"></i>Institution
          </a>
          <ul class="dropdown-menu">
            <li><a class="dropdown-item" th:href="@{/institution/dashboard}"><i class="bi bi-speedometer2 me-2"></i>Dashboard</a></li>
            <li><a class="dropdown-item" th:href="@{/institution/profile}"><i class="bi bi-building me-2"></i>Profil</a></li>
            <li><a class="dropdown-item" th:href="@{/institution/structure}"><i class="bi bi-diagram-3 me-2"></i>Structure</a></li>
            <li><a class="dropdown-item" th:href="@{/institution/approvals}"><i class="bi bi-person-check me-2"></i>Approbations</a></li>
            <li><a class="dropdown-item" th:href="@{/institution/library}"><i class="bi bi-collection me-2"></i>Bibliothèque</a></li>
          </ul>
        </li>

        <!-- Professeur -->
        <li class="nav-item dropdown" sec:authorize="hasRole('PROF')">
          <a class="nav-link dropdown-toggle px-2" href="#" role="button" data-bs-toggle="dropdown">
            <i class="bi bi-person-workspace me-1"></i>Professeur
          </a>
          <ul class="dropdown-menu">
            <li><a class="dropdown-item" th:href="@{/prof/dashboard}"><i class="bi bi-speedometer2 me-2"></i>Dashboard</a></li>
            <li><a class="dropdown-item" th:href="@{/prof/courses}"><i class="bi bi-journal-richtext me-2"></i>Mes cours</a></li>
            <li><a class="dropdown-item" th:href="@{/prof/classrooms}"><i class="bi bi-people-fill me-2"></i>Mes classes</a></li>
            <li><a class="dropdown-item" th:href="@{/prof/exam}"><i class="bi bi-file-earmark-text me-2"></i>Examens</a></li>
            <li><hr class="dropdown-divider"></li>
            <li><a class="dropdown-item" th:href="@{/my-institutions}"><i class="bi bi-building me-2"></i>Institutions</a></li>
            <li><hr class="dropdown-divider"></li>
            <li><a class="dropdown-item" th:href="@{/profile}"><i class="bi bi-person-circle me-2"></i>Mon profil</a></li>
          </ul>
        </li>

        <!-- Étudiant -->
        <li class="nav-item dropdown" sec:authorize="hasRole('ETUDIANT')">
          <a class="nav-link dropdown-toggle px-2" href="#" role="button" data-bs-toggle="dropdown">
            <i class="bi bi-mortarboard me-1"></i>Étudiant
          </a>
          <ul class="dropdown-menu">
            <li><a class="dropdown-item" th:href="@{/student/dashboard}"><i class="bi bi-speedometer2 me-2"></i>Dashboard</a></li>
            <li><a class="dropdown-item" th:href="@{/student/courses}"><i class="bi bi-book me-2"></i>Mes cours</a></li>
            <li><a class="dropdown-item" th:href="@{/student/classes}"><i class="bi bi-mortarboard me-2"></i>Mes classes</a></li>
            <li><a class="dropdown-item" th:href="@{/student/reviewbook}"><i class="bi bi-journal-bookmark me-2"></i>ReviewBook</a></li>
            <li><hr class="dropdown-divider"></li>
            <li><a class="dropdown-item" th:href="@{/my-institutions}"><i class="bi bi-building me-2"></i>Mon institution</a></li>
            <li><hr class="dropdown-divider"></li>
            <li><a class="dropdown-item" th:href="@{/profile}"><i class="bi bi-person-circle me-2"></i>Mon profil</a></li>
          </ul>
        </li>
      </ul>

      <div class="d-flex gap-2 align-items-center flex-wrap">
        <div sec:authorize="isAuthenticated()" class="d-flex align-items-center gap-3">
          <div class="d-flex align-items-center gap-2">
            <div class="rounded-circle d-flex align-items-center justify-content-center"
                 style="width:32px;height:32px;background:rgba(255,255,255,0.15);">
              <i class="bi bi-person-fill text-white small"></i>
            </div>
            <span class="text-white fw-medium d-none d-lg-inline" sec:authentication="principal.fullName">User</span>
          </div>
          <form th:action="@{/logout}" method="post" class="d-inline m-0">
            <button class="btn btn-outline-light btn-sm" type="submit">
              <i class="bi bi-box-arrow-right me-1"></i>Déconnexion
            </button>
          </form>
        </div>
        <div sec:authorize="!isAuthenticated()" class="d-flex gap-2">
          <a class="btn btn-outline-light btn-sm" th:href="@{/login}">
            <i class="bi bi-box-arrow-in-right me-1"></i>Connexion
          </a>
          <a class="btn btn-primary btn-sm" th:href="@{/register}">
            <i class="bi bi-person-plus me-1"></i>Créer un compte
          </a>
        </div>
      </div>
    </div>
  </div>
</nav>
</body>
</html>